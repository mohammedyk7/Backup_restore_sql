# üßæ TrainingDB Backup & Restore Error Log

**Student:** Mohammed Yusuf Alkhusaibi
**Date:** 2025-05-29

---

## üîç 1. Initial Backup Error

SQL Server threw an **Access Denied (Error 5)** when trying to back up `TrainingDB` to the `Downloads` folder.

**Cause:** SQL Server service account did not have write permission.

**Fix:** Added `NT SERVICE\MSSQLSERVER` to folder permissions and granted full control.

## üõ† 2. Restore Error - Database in Use

Tried to restore `TrainingDB` while it was in use.

**Fix:** Used `ALTER DATABASE SET SINGLE_USER WITH ROLLBACK IMMEDIATE` before restore.

## ‚ùå 3. Restore Chain Failure (Differential)

Restored differential `.bak` file directly after database drop.

**Error:** `Cannot be restored because the database has not been restored to the correct earlier state.`

**Cause:** Full backup used did **not match** the base LSN of the differential.

## üß† 4. Investigating Backup Chain with `RESTORE HEADERONLY`

Used `RESTORE HEADERONLY` to compare LSNs of full and differential backups.

- Full CheckpointLSN: `39000000635000001`

- Differential BaseLSN: `39000000775000001`

**Result:** LSN mismatch ‚Üí invalid restore sequence.

## ‚úÖ 5. Solution: Recreated Clean Backup Chain

Steps:
- Dropped DB
- Recreated and inserted sample data
- Took fresh **full backup**
- Inserted more data
- Took **differential backup**
- Restored full backup with `NORECOVERY`
- Restored differential backup with `RECOVERY`

### ‚úîÔ∏è Final Verification
Restored database shows all 3 student rows:
- Sara Ali
- Mohammed Nasser
- Fatma Said


---
**Status:** ‚úÖ SUCCESSFULLY RESTORED with full + differential chain
